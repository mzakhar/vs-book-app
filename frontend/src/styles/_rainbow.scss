@use 'variables' as *;

// ── Rainbow Theme Keyframes ────────────────────────────────────────────────

@keyframes rainbow-shift {
  0%   { background-position: 0% center; }
  100% { background-position: 200% center; }
}

@keyframes rainbow-scroll {
  0%   { background-position: 0 0%; }
  100% { background-position: 0 100%; }
}

@keyframes rainbow-glow {
  0%   { box-shadow: 0 8px 28px rgba(255, 110, 180, 0.55), 0 0 0 1px #ff6eb4; }
  16%  { box-shadow: 0 8px 28px rgba(255, 170, 68,  0.55), 0 0 0 1px #ffaa44; }
  33%  { box-shadow: 0 8px 28px rgba(255, 221, 68,  0.55), 0 0 0 1px #ffdd44; }
  50%  { box-shadow: 0 8px 28px rgba(68,  255, 170, 0.55), 0 0 0 1px #44ffaa; }
  66%  { box-shadow: 0 8px 28px rgba(68,  204, 255, 0.55), 0 0 0 1px #44ccff; }
  83%  { box-shadow: 0 8px 28px rgba(170, 102, 255, 0.55), 0 0 0 1px #aa66ff; }
  100% { box-shadow: 0 8px 28px rgba(255, 110, 180, 0.55), 0 0 0 1px #ff6eb4; }
}

@keyframes sparkle-twinkle {
  0%, 100% { opacity: 0;   transform: scale(0.4) rotate(0deg);  }
  50%       { opacity: 1;   transform: scale(1.2) rotate(72deg); }
}

@keyframes sparkle-float {
  0%, 100% { opacity: 0;   transform: scale(0.5) translateY(0px)  rotate(0deg);  }
  40%       { opacity: 0.9; transform: scale(1.1) translateY(-4px) rotate(60deg); }
  60%       { opacity: 0.7; transform: scale(1.0) translateY(-6px) rotate(90deg); }
}

// ── Rainbow Theme Overrides ────────────────────────────────────────────────

[data-theme="rainbow"] {

  // Animated rainbow sidebar border
  .sidebar {
    border-right: none;

    &::after {
      content: '';
      position: absolute;
      top: 0; right: 0;
      width: 2px;
      height: 100%;
      background: linear-gradient(
        180deg,
        #ff6eb4 0%, #ff9944 18%, #ffdd44 35%,
        #44ffaa 52%, #44ccff 68%, #aa66ff 85%, #ff6eb4 100%
      );
      background-size: 100% 200%;
      animation: rainbow-scroll 3s linear infinite;
    }
  }

  // Rainbow gradient brand title
  .sidebar__brand-title {
    background: linear-gradient(
      90deg,
      #ff6eb4, #ff9944, #ffdd44, #44ffaa, #44ccff, #aa66ff, #ff6eb4
    );
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: rainbow-shift 3s linear infinite;
  }

  // Sparkles in the brand bar
  .sidebar__brand {
    overflow: visible;

    &::before {
      content: '✦';
      position: absolute;
      top: 6px; right: 10px;
      font-size: 0.55rem;
      color: #ffdd44;
      animation: sparkle-twinkle 2.1s ease-in-out infinite;
      pointer-events: none;
    }

    &::after {
      content: '✶';
      position: absolute;
      bottom: 6px; left: 6px;
      font-size: 0.5rem;
      color: #44ccff;
      animation: sparkle-twinkle 1.8s ease-in-out infinite 0.6s;
      pointer-events: none;
    }
  }

  // Sparkles floating in the nav section
  .sidebar__nav {
    &::before {
      content: '✸';
      position: absolute;
      top: 20px; right: 14px;
      font-size: 0.6rem;
      color: #ff9944;
      animation: sparkle-float 2.6s ease-in-out infinite 0.9s;
      pointer-events: none;
    }

    &::after {
      content: '★';
      position: absolute;
      bottom: 40px; right: 18px;
      font-size: 0.45rem;
      color: #44ffaa;
      animation: sparkle-float 3s ease-in-out infinite 0.3s;
      pointer-events: none;
    }
  }

  // Sparkle near the theme switcher row
  .sidebar__theme {
    &::before {
      content: '✦';
      position: absolute;
      top: 4px; left: 12px;
      font-size: 0.45rem;
      color: #aa66ff;
      animation: sparkle-twinkle 2.4s ease-in-out infinite 1.2s;
      pointer-events: none;
    }
  }

  // Wider rainbow active nav indicator
  .nav-item--active::before {
    background: linear-gradient(180deg, #ff6eb4, #aa66ff, #44ccff) !important;
    width: 3px !important;
  }

  // Rainbow gradient primary button
  .btn--primary {
    background: linear-gradient(90deg, #ff6eb4, #aa66ff, #44ccff, #ff6eb4);
    background-size: 300% auto;
    animation: rainbow-shift 4s linear infinite;

    &:hover { filter: brightness(1.15); }
  }

  // Rainbow glow on book card hover
  .book-card:hover {
    border-color: transparent;
    transform: translateY(-3px);
    animation: rainbow-glow 2s linear infinite;
  }

  // Rainbow glow on gallery cover hover
  .book-gallery__item:hover .book-gallery__cover-wrap {
    transform: translateY(-4px);
    animation: rainbow-glow 2s linear infinite;
  }

  // Rainbow gradient page headings
  .page h1 {
    background: linear-gradient(
      90deg,
      #ff6eb4, #ff9944, #ffdd44, #44ffaa, #44ccff, #aa66ff, #ff6eb4
    );
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: rainbow-shift 4s linear infinite;
  }
}
